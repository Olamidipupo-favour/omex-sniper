<!DOCTYPE html>
<html>
<head>
    <title>Frontend Events Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .event { margin: 5px 0; padding: 5px; border-left: 3px solid #007bff; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .connected { background: #d4edda; }
        .disconnected { background: #f8d7da; }
    </style>
</head>
<body>
    <h1>Frontend Events Test</h1>
    
    <div id="connectionStatus" class="status disconnected">
        <strong>Status:</strong> <span id="statusText">Disconnected</span>
    </div>
    
    <div>
        <h3>Received Events:</h3>
        <div id="eventLog">
            <div class="event">Waiting for events...</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    <script>
        const socket = io();

        socket.on('connect', () => {
            console.log('✅ Connected');
            document.getElementById('statusText').textContent = 'Connected';
            document.getElementById('connectionStatus').className = 'status connected';
            addEvent('connect', 'Connected to server');
        });

        socket.on('disconnect', () => {
            console.log('❌ Disconnected');
            document.getElementById('statusText').textContent = 'Disconnected';
            document.getElementById('connectionStatus').className = 'status disconnected';
            addEvent('disconnect', 'Disconnected from server');
        });

        // Test all the new events
        socket.on('new_token', (data) => {
            console.log('🆕 New token:', data);
            addEvent('new_token', data);
        });

        socket.on('position_update', (data) => {
            console.log('📊 Position update:', data);
            addEvent('position_update', data);
        });

        socket.on('transaction', (data) => {
            console.log('💳 Transaction:', data);
            addEvent('transaction', data);
        });

        socket.on('transaction_update', (data) => {
            console.log('🔄 Transaction update:', data);
            addEvent('transaction_update', data);
        });

        socket.on('price_update', (data) => {
            console.log('💰 Price update:', data);
            addEvent('price_update', data);
        });

        socket.on('trade_update', (data) => {
            console.log('📈 Trade update:', data);
            addEvent('trade_update', data);
        });

        socket.on('auto_buy_success', (data) => {
            console.log('✅ Auto buy success:', data);
            addEvent('auto_buy_success', data);
        });

        socket.on('auto_buy_error', (data) => {
            console.log('❌ Auto buy error:', data);
            addEvent('auto_buy_error', data);
        });

        socket.on('error', (data) => {
            console.log('🚨 Error:', data);
            addEvent('error', data);
        });

        function addEvent(eventType, data) {
            const eventLog = document.getElementById('eventLog');
            const eventDiv = document.createElement('div');
            eventDiv.className = 'event';
            
            const timestamp = new Date().toLocaleTimeString();
            eventDiv.innerHTML = `
                <strong>[${timestamp}] ${eventType}:</strong>
                <pre>${JSON.stringify(data, null, 2)}</pre>
            `;
            
            eventLog.appendChild(eventDiv);
            
            // Keep only last 10 events
            const events = eventLog.querySelectorAll('.event');
            if (events.length > 10) {
                events[0].remove();
            }
        }
    </script>
</body>
</html> 